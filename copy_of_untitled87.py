# -*- coding: utf-8 -*-
"""Copy of Untitled87.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1oD9UmoMRobbVrUuCVyjhF8CCDjTT62h2
"""

csv_urls=['https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/AARTIIND__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/AARTIIND__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/ABCAPITAL__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/ABCAPITAL__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/ABFRL__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/ABFRL__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/ADANIENT__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/ADANIENT__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/ADANIGAS__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/ADANIGAS__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/ADANIPORTS__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/ADANIPORTS__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/AJANTPHARM__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/AJANTPHARM__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/AMARAJABAT__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/AMARAJABAT__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/APLLTD__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/APLLTD__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/APOLLOHOSP__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/APOLLOHOSP__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/APOLLOTYRE__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/APOLLOTYRE__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/ASHOKLEY__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/ASHOKLEY__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/ASIANPAINT__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/ASIANPAINT__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/AUBANK__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/AUBANK__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/AXISBANK__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/AXISBANK__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/BAJAJFINSV__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/BAJAJFINSV__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/BAJAJ_AUTO__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/BAJAJ_AUTO__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/BAJFINANCE__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/BAJFINANCE__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/BALKRISIND__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/BALKRISIND__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/BANKINDIA__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/BANKINDIA__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/BATAINDIA__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/BATAINDIA__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/BBTC__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/BBTC__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/BEL__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/BEL__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/BHARATFORG__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/BHARATFORG__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/BHARTIARTL__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/BHARTIARTL__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/BHEL__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/BHEL__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/BPCL__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/BPCL__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/BRITANNIA__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/BRITANNIA__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/CANBK__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/CANBK__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/CASTROLIND__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/CASTROLIND__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/CESC__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/CESC__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/CHOLAFIN__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/CHOLAFIN__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/CIPLA__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/CIPLA__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/COALINDIA__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/COALINDIA__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/COFORGE__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/COFORGE__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/COROMANDEL__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/COROMANDEL__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/CROMPTON__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/CROMPTON__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/CUB__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/CUB__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/CUMMINSIND__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/CUMMINSIND__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/DALBHARAT__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/DALBHARAT__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/DHANI__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/DHANI__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/DIVISLAB__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/DIVISLAB__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/DRREDDY__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/DRREDDY__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/EDELWEISS__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/EDELWEISS__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/EICHERMOT__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/EICHERMOT__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/EMAMILTD__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/EMAMILTD__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/ENDURANCE__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/ENDURANCE__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/ESCORTS__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/ESCORTS__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/EXIDEIND__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/EXIDEIND__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/FEDERALBNK__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/FEDERALBNK__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/FORTIS__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/FORTIS__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/FRETAIL__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/FRETAIL__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/GAIL__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/GAIL__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/GLENMARK__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/GLENMARK__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/GMRINFRA__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/GMRINFRA__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/GODREJAGRO__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/GODREJAGRO__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/GODREJIND__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/GODREJIND__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/GODREJPROP__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/GODREJPROP__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/GRASIM__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/GRASIM__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/GSPL__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/GSPL__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/GUJGASLTD__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/GUJGASLTD__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/HCLTECH__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/HCLTECH__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/HDFCBANK__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/HDFCBANK__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/HDFC__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/HDFC__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/IBULHSGFIN__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/IBULHSGFIN__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/ICICIBANK__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/ICICIBANK__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/IDEA__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/IDEA__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/IDFCFIRSTB__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/IDFCFIRSTB__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/INDHOTEL__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/INDHOTEL__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/INDUSINDBK__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/INDUSINDBK__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/INFY__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/INFY__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/IOC__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/IOC__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/IPCALAB__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/IPCALAB__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/IRCTC__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/IRCTC__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/ISEC__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/ISEC__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/ITC__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/ITC__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/JINDALSTEL__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/JINDALSTEL__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/JSWENERGY__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/JSWENERGY__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/JSWSTEEL__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/JSWSTEEL__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/JUBLFOOD__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/JUBLFOOD__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/KOTAKBANK__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/KOTAKBANK__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/LALPATHLAB__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/LALPATHLAB__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/LICHSGFIN__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/LICHSGFIN__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/LTTS__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/LTTS__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/LT__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/LT__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/L_TFH__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/L_TFH__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/MANAPPURAM__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/MANAPPURAM__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/MARUTI__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/MARUTI__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/MFSL__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/MFSL__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/MGL__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/MGL__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/MINDTREE__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/MINDTREE__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/MPHASIS__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/MPHASIS__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/MRF__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/MRF__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/M_MFIN__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/M_MFIN__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/M_M__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/M_M__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/NAM_INDIA__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/NAM_INDIA__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/NATCOPHARM__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/NATCOPHARM__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/NATIONALUM__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/NATIONALUM__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/NAVINFLUOR__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/NAVINFLUOR__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/NESTLEIND__EQ__NSE__NSE__MINUTE.csv', 'https://raw.githubusercontent.com/ShabbirHasan1/NSE-Data/main/NSE%20Minute%20Data/NSE_Stocks_Data/NESTLEIND__EQ__NSE__NSE__MINUTE.csv']

from pyspark.sql import functions as F
from pyspark.sql import SparkSession
from pyspark.sql.functions import lag, col,window
import pandas as pd
from pyspark.sql.window import Window, WindowSpec
from pyspark.sql.functions import col, isnull, count, when
from functools import reduce
import numpy as np

from pyspark.sql.functions import col, when

spark = SparkSession.builder.appName("StockPercentageChange").getOrCreate()

windowSpec = Window.orderBy("timestamp").rowsBetween(Window.unboundedPreceding, Window.currentRow)

def get_data(data_url):
    pandas_df = pd.read_csv(data_url)
    stock_df = spark.createDataFrame(pandas_df)
    stock_df = stock_df.orderBy("timestamp")
    return stock_df

def get_null_summary(df):
    null_summary = df.select(
        [
            count(when(isnull(c), c)).alias(c)
            for c in df.columns
        ]
    )
    return null_summary


def get_stock_pct_change(stock_df):
    stock_df_with_pct_changes = stock_df.withColumn(
    "pct_change_close",
    (col("close") - lag("close", 1).over(Window.orderBy("timestamp"))) / lag("close", 1).over(Window.orderBy("timestamp")) * 100
).withColumn(
    "pct_change_open",
    (col("open") - lag("open", 1).over(Window.orderBy("timestamp"))) / lag("open", 1).over(Window.orderBy("timestamp")) * 100
).withColumn(
    "pct_change_high",
    (col("high") - lag("high", 1).over(Window.orderBy("timestamp"))) / lag("high", 1).over(Window.orderBy("timestamp")) * 100
).withColumn(
    "pct_change_low",
    (col("low") - lag("low", 1).over(Window.orderBy("timestamp"))) / lag("low", 1).over(Window.orderBy("timestamp")) * 100
).withColumn(
    "pct_change_volume",
    (col("volume") - lag("volume", 1).over(Window.orderBy("timestamp"))) / lag("volume", 1).over(Window.orderBy("timestamp")) * 100
)
    return stock_df_with_pct_changes


def get_percentile_stats(stock_df_with_pct_changes):
  percentiles = [0.95, 0.99, 0.995, 0.9995, 0.99995]
  columns = ["pct_change_close", "pct_change_open", "pct_change_high", "pct_change_low", "pct_change_volume"]
  results = []
  for column in columns:
    percentile_values = stock_df_with_pct_changes.approxQuantile(column, percentiles, 0.01)

    for p, value in zip(percentiles, percentile_values):
        # Count trades exceeding the percentile value
        num_exceeding = stock_df_with_pct_changes.filter(col(column) > value).count()

        results.append([column, p * 100, value, num_exceeding])

  # Create a Pandas DataFrame for better presentation
  df_results = pd.DataFrame(results, columns=["Column", "Percentile", "Value", "Trades Exceeding"])
  return df_results

def get_data(data_url):
    pandas_df = pd.read_csv(data_url)
    stock_df = spark.createDataFrame(pandas_df)
    stock_df = stock_df.orderBy("timestamp")
    return stock_df

def get_null_summary(df):
    null_summary = df.select(
        [
            count(when(isnull(c), c)).alias(c)
            for c in df.columns
        ]
    )
    return null_summary


def get_stock_pct_change_close(stock_df):
    stock_df_with_pct_changes = stock_df.withColumn(
    "pct_change_close",
    (col("close") - lag("close", 1).over(Window.orderBy("timestamp"))) / lag("close", 1).over(Window.orderBy("timestamp")) * 100
)
    return stock_df_with_pct_changes


def get_percentile_stats_close(stock_df_with_pct_changes):
  percentiles = [0.95, 0.99, 0.995, 0.9995, 0.99995]
  columns = ["pct_change_close"]
  results = []
  for column in columns:
    percentile_values = stock_df_with_pct_changes.approxQuantile(column, percentiles, 0.01)

    for p, value in zip(percentiles, percentile_values):
        # Count trades exceeding the percentile value
        num_exceeding = stock_df_with_pct_changes.filter(col(column) > value).count()

        results.append([column, p * 100, value, num_exceeding])

  # Create a Pandas DataFrame for better presentation
  df_results = pd.DataFrame(results, columns=["Column", "Percentile", "Value", "Trades Exceeding"])
  return df_results

def main(data_url):
    stock_df = get_data(data_url)
    data=get_stock_pct_change_close(stock_df)
    stat=get_percentile_stats_close(data)
    display(stat)
    return stat

def final(csv_urls):
  for url in csv_urls[:3]:
    stat=main(url)
    csv_name=url.split('/')[-1]
    stat.write.mode("overwrite").csv("gs://big-data-wk5/"+csv_name, header=True)

final(csv_urls)

